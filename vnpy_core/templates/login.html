<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <meta http-equiv="keywords" content="关键字,关键字,关键字"/>
  <meta http-equiv="pragma" content="no-cache"/>
  <meta http-equiv="cache-control" content="no-cache"/>
  <meta http-equiv="expires" content="0"/>
  <meta name="description" content="页面描述不超过150个字符"/>
  <meta name="Author" content="页面作者"/>
  <meta name="renderer" content="webkit"/>
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
  <link rel="shortcut icon" href="../static/favicon.ico" type="image/x-icon" >
  <link rel="stylesheet" type="text/css" href="../static/layui/dist/css/layui.css"/>
  <link rel="stylesheet" href="../static/stylesheets/gx_main.min.css" />
  <link rel="stylesheet" type="text/css" href="../static/iconfont/iconfont.css">
  <!--[if lt IE 9]>
  <script src="../static/html5shiv/dist/html5shiv.min.js"></script>
  <script src="../static/respond/dest/respond.min.js"></script>
  <![endif]-->
  <script src="../static/jquery/dist/jquery.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="../static/layui/dist/layui.all.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript" src="../static/highcharts-5.0.14/code/highcharts.js"></script>
  <!--mine-->
{#  <script src="../static/javascripts/gx_main.min.js" type="text/javascript" charset="utf-8"></script>#}
    <script src="../static/javascripts/gx_main.min.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="login">
<div class="layui-container" id="loginBox">
{#  <img id="loginLogo" src="../static/login_logo.png" alt="">#}
  <form class="layui-form" id="loginForm" method="post">
		{% csrf_token %}
    <div class="layui-form-item text_center">
      <img src="../static/login_header.png" alt="">
    </div>
    <div class="layui-form-item login_form_row">
      <label class="layui-form-label">
        <span class="iconfont icon-gx_yonghu1"></span>
      </label>
      <div class="layui-input-inline">
        <input class="layui-input" name="UserName" type="text" required lay-verify="required" placeholder="请输入用户名" autocomplete="off">
      </div>
    </div>
    <div class="layui-form-item login_form_row">
      <label class="layui-form-label">
        <span class="iconfont icon-gx_suo"></span>
      </label>
      <div class="layui-input-inline">
        <input class="layui-input" name="PassWord" type="password" required lay-verify="required" placeholder="请输入密码" autocomplete="off">
      </div>
    </div>
    <div class="layui-form-item text_center">
      <button class="layui-btn" id="login_sub" lay-submit lay-filter="login_sub">登录</button>
    </div>
  </form>
</div>


<script type="text/javascript">
    layui.use
		(
			['form','layer','jquery'], function()
			{
				var form = layui.form,layer = layui.layer,$ = layui.jquery;
				//点击Enter键登陆
				$(document).keydown(function(event)
				{
					if (event.keyCode == 13){
						setTimeout(login,100);
					}
				});
			
				$(document).ready(function()
				{
					//用户名文本框获得焦点
					$("input[name=UserName]").focus();
					//按键登录
//				  $("#login_sub").click(function(){
//						login();
//					});

				 });

				
				//判断用户是否存在	
				$("input[name=PassWord]").focus(function(){
					var name = $("input[name=UserName]").val()
					$.ajax({
						url:"check_user/",
						data:{"UserName":name},
						type:"post",
						dataType:"json",
						async:true,
						success:function(data){
							console.log("成功：");
							console.log(data.msg);
							if(data.msg == "exsit"){
								
							}else if(data.msg == "not_exsit"){
								var user_name = $("input[name=UserName]");
								console.dir(user_name);
								user_name.val("");
								user_name.attr("placeholder","用户名不存在"); 			 
							}
						},
						error:function(err){
							console.log("失败：" + err);
							//用户名文本框获得焦点
							$("input[name=UserName]").focus();
		//					layer.alert(val.error);
						},
					});
				});
				
				//按键登录
				/*$("#login_sub").click(function(){
					var name = $("input[name=UserName]").val(),pwd = $("input[name=PassWord]").val();
					var fileName = "login.html";

					var json = {"UserName":name,"PassWord":pwd,"FileName":fileName};
				
//					eval('var val='+json); 

					$.ajax({
						url:"index/",
						type:"post",
						data:json,
						dataType:"json",
						async:true,
						success:function(data){
							console.log("成功：");
							console.dir(data);
							
		//					location.href = val.success;
						},
						error:function(err){
							console.dir(err);
							//用户名文本框获得焦点
//							$("input[name=UserName]").focus();
		//					layer.alert(val.error);
						},
					});
				});*/
				

				//登录方法
				function login()
				{
					var name = $("input[name=UserName]").val(),pwd = $("input[name=PassWord]").val();
					var fileName = "login.html";

					var json = {"UserName":name,"PassWord":pwd,"FileName":fileName};


					$.post("index/",json,function(data)
					{
						console.log(data);
//						eval('var val='+data); ;
//						if(val.error)
//						{
//							layer.alert(val.error);
//						}else if(val.success)
//						{
//							location.href = val.success;
//						}
					});
				}

    	}
		);
</script>
</body>
</html>
